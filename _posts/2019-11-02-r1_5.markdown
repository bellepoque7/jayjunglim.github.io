---
title: "분포, 표본, 검정"
date: 2017-11-02  09:00:00 -0400
categories: R
---

# 7장 통계분석

- 1. 난수 생성 및 분포함수

    [분포의 종류와 함수](https://www.notion.so/a411536e3a7d4bb9aee18303b46c7a2c)

    [통계함수의 종류](https://www.notion.so/d57bb0357e3442999e3c0c097aeabddf)

        #정규분포 생성하기(100개, 평균0, 편차10)
        rnorm(100,0,10)
        
        #정규분포그리기
        plot(density(x=rnorm(1000000,0,10))

- 2. 기초통계량 & 3. 표본추출

    [R의 함수](https://www.notion.so/040f96e8336a404f8850d6ef1c1582a3)

    ## 2. 표본추출

        #종별로 3개씩 층화추출한 ID, 확률, 층 반환
        x<- strata(c("Species"), size = c(3,3,3), 
                   method ="srswor",data=iris)
        
        #층화추출 기준으로 데이터 가져오기
        getdata(iris,x)

    ### 2-4 계통 추출

    임의 위치에서 시작해 매 k 항목을 표본으로 추출하는 방법

    데이터가 임의로 분포된 경우 단순 임의 추출과 동일한 효과를 모이며, 추정 값(평균)의 분산이 작다.

    but  주기성이 존재하면 편향된 추정 값을 반환

        # 1:10벡터에서 계통 추출
        # ~ 우측에 쓴 숫자에 따라 그룹핑
        # frac에 지정한 숫자*데이터의 갯수만큼 추출
        x <- data.frame(x=1:10)
        sampleBy(~1, frac =.3, data = x, systamatic =T)

- 4. 분할표

    4-1 분할표 작성

    - tabs을 이용한 분할표 작성

            # 도수를 지정한 분할표 작성, formula를 확인
            d <- data.frame(x=c('1','2','2','1'), y=c('A','B','A','B'), num =c(3,5,8,7))
            xt <- xtabs(num ~ x+y, data=d)
            xt
            # 주변 합 계산
            margin.table(xt)  #총합계산
            # 비율 계산
            prop.table(xt)
            
            # 도수를 지정하지 않으면 알아서 count된다.
            d2 <- data.frame(x=c('A','A','A','B','B'))
            xtabs(~x, data=d2)

    ### 4-3 독립성 검정

    카이제곱 검정

    만약 분할표에서 행(i)과 열(j)이 독립이라면 다음과 같은 식이 성립한다.

    `$$
    P(i,j) = P(i) * P(j)
    $$`

    변수 간의 독립성 검정에는 카이 제곱 검정을 사용하며 이때 사용되는 통계량은 다음과 같다

    `$$
    \sum_{i=1}^{r} \sum_{j=1}^{c} \frac{O_{ij}-E_{ij}}{E_{ij}} \sim \chi^{2}(r-1)(c-1)
    $$`

    r:행의 수, c:열의 수, O_ij는 분할표의 (i,j)의 셀에 기록되어있는 값, E_ij는 분할표의 두 변수가 독립일때 (i,j) 셀에 대한 기댓값.

    - 실행 예제

    성별과 운동빈도는 관계있는지를 확인하는 카이제곱 검정

    ![](Untitled-61f79d97-69d5-477e-a3bd-20ffd1324ed2.png)

    ![](Untitled-a5f576df-f5a9-4585-81aa-04454700d767.png)

    귀무가설은 기각 된다.

    ### 4-4 피셔의 정확검정

    표본이 매우 적거나 분할표에 표본이 치우져져 있을때 카이제곱검정이 부정확함을 극복 하는 방법

    ex) 기대 빈도 5이하 인 셀이 전체의 20%이상인 경우

    - 실행 예제

    글쓰는 손과 박수칠 때 위로 올라가는 손의 검정 

    ![](Untitled-5ce34809-501e-4d93-9d13-fa38e3f24998.png)

    ![](Untitled-561c477d-4d17-4776-90c4-78a4f7359828.png)

    값이 작아 경고 메세지를 출력

    ![](Untitled-89e9752b-6bd3-46b6-ac81-ac31dd3a7ed9.png)

    귀무가설 기각, 대립가설(둘사의 관계가 있다) 채택

    ### 4-5 맥니마 검정

    응답자의 성향이 사건 전후에 달라지는지 알아보는 경우

    ![](Untitled-f13280cd-3bfa-4aa4-8067-f7f3578ae9dd.png)

    사건 전후의 응답자 수(n)이 동일하다면

    a + b = a + c  & c +d = b + d  따라서 b = c임을 확인하면 된다.

    b = c 이라면 b는 b+c의 절반 값이 되어야 하므로 이항분포를 따른다.

    $$b \sim B(b+c, \frac{1}{2})$$

    - 실행 예제

    한달 간격의 미국인 1600명에 대한 대통령 지지율 조사

    ![](Untitled-bebc65df-5963-4614-b972-4668cf35d804.png)

    귀무가설 기각, 사건 전후에 비율의 차이가 발생되었다.

- 5. 적합도 검정

    통계분석은 특정 분포에 기반하여 진행된다.

    특히 데이터가 클수록 정규분포를 따름을 가정하기도 한다. 실제로 그 분포를 따르는지 확인해 볼 수 있다.

    ### 5-1 카이제곱 검정

    - 실행 예제

    글씨를 왼손으로 쓰는 사람과 오른손으로 쓰는 사람의 비율이 3:7인지 여부를 확인해보자.

    귀무가설: 관측데이터가 30:70의 분포를 따른다.

    ![](Untitled-7fd32560-e5aa-4285-825b-500ae5cc7b8d.png)

    귀무가설을 기각한다. 3:7 비율이 아니다.

    ### 5-2 샤피로 월크 검정

    표본이 정규분포로 부터 추출된 것인지 테스트하기 위한 방법

    - 실행 예제

    정규분포로부터 1000개의 난수를 만들어 검정

    ![](Untitled-d027b8dc-3150-439e-93c2-e814388e84bb.png)

    데이터가 정규분포를 따른다는 귀무 가설 채택

    ### 5-3 콜모고로프 스미르노프 검정(K-S test)

    데이터의 누적 분포함수와 비교하고자 하는 분포의 누적 함수간의 최대 거리를 통계량으로 사용하는 가설 검정

    - 실행 예제

    귀무가설: 두 분포가 누적분포함수를 기준으로 비교하여 다르다

    ![](Untitled-0d5d89d3-2c21-489d-ac5c-3cb15fbf0474.png)

    다르지않다. 귀무가설 채택

    ![](Untitled-e8458e22-5d8b-4d70-af2f-ce6d2df4162a.png)

    정규분포와 균일분포가 다른가? → 귀무가설 기각 → 다르다.

    ### Q-Q 도

    데이터가 특정 분포를 따르는지 시각적으로 검토하는 방법

        x <- rnorm(1000, mean =10, sd= 1)
        # 주어진 데이터와 정규확률분포를 비교하는 Q-Q도를 그린다.
        qqnorm(x)
        # 두 데이터 셋에 대한 Q-Q도를 그린다.
        qqplot(x,y)
        # 데이터와 분포를 비교해 이론적으로 성립해야하는 직선 관계를 그린다.
        qqline(x, lty = 2)

    ![](Untitled-0ac4b6ed-f6d3-4040-8e60-377eadecf869.png)

##